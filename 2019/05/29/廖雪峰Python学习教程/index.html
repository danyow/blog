<!DOCTYPE html>
<html lang="en">

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  
  
  <title>廖雪峰Python学习教程</title>
  <meta name="description" content="小白入门, 以前的笔记。">
  

  <link rel="stylesheet" href="/assets/main.css">
  <link rel="canonical" href="https://blog.danyow.cn/2019/05/29/%E5%BB%96%E9%9B%AA%E5%B3%B0Python%E5%AD%A6%E4%B9%A0%E6%95%99%E7%A8%8B/">
  
  
  <link rel="alternate" type="application/rss+xml" title="📒 Danyow" href="https://blog.danyow.cn/feed.xml">

  

  
  <meta property="og:title" content="廖雪峰Python学习教程">
  <meta property="og:site_name" content="📒 Danyow">
  <meta property="og:url" content="https://blog.danyow.cn/2019/05/29/%E5%BB%96%E9%9B%AA%E5%B3%B0Python%E5%AD%A6%E4%B9%A0%E6%95%99%E7%A8%8B/">
  <meta property="og:description" content="小白入门, 以前的笔记。">
  
  
  <meta name="twitter:card" content="summary">
  
  <meta name="twitter:title" content="廖雪峰Python学习教程">
  <meta name="twitter:description" content="小白入门, 以前的笔记。">
  
  

  <link rel="dns-prefetch" href="https://fonts.gstatic.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css?family=Bitter:400,400i,700&display=swap" rel="stylesheet">

  

</head>


  <body>

    <header class="site-header">

  <div class="wrapper">

    <a class="site-title" href="/">📒 Danyow</a>

    <nav class="site-nav">
      
        
        <a class="page-link" href="/about/">关于</a>
      
        
        <a class="page-link" href="/archives/">归档</a>
      
        
        <a class="page-link" href="https://github.com/danyow">GitHub</a>
      
    </nav>

  </div>

</header>


    <main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    
      <h1 class="post-title" itemprop="name headline">廖雪峰Python学习教程</h1>
    
    <p class="post-meta"><time datetime="2019-05-29T14:19:59+00:00" itemprop="datePublished">May 29, 2019</time> •
  
    
    
      
    
      
    
      
    
      
    
      
        <a href="/categories/%E7%AC%94%E8%AE%B0/">笔记</a>,
      
    
      
    
      
    
      
    
      
    
  
    
    
      
    
      
    
      
    
      
    
      
    
      
        <a href="/categories/python/">python</a>
      
    
      
    
      
    
      
    
  



</p>
  </header>

  <div class="post-content" itemprop="articleBody">
    <p>小白入门, 以前的笔记。</p>

<h2 id="函数">函数</h2>

<h3 id="函数的参数">函数的参数</h3>

<ul>
  <li>当默认参数为可变对象的时候 eg:</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">add_end</span><span class="p">(</span><span class="n">L</span><span class="o">=</span><span class="p">[]):</span>
    <span class="n">L</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">'END'</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">L</span>

<span class="s">'''
如果多次调用该函数
就会导致L的值不断递增
&gt;&gt;&gt; add_end()
['END', 'END']
&gt;&gt;&gt; add_end()
['END', 'END', 'END']
因为L也是一个变量
所以最佳做法是将 L=None
在函数内部去做判断
'''</span>
</code></pre></div></div>

<ul>
  <li>定义可变参数的的函数</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">calc</span><span class="p">(</span><span class="o">*</span><span class="n">numbers</span><span class="p">):</span>
    <span class="nb">sum</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">numbers</span><span class="p">:</span>
        <span class="nb">sum</span> <span class="o">=</span> <span class="nb">sum</span> <span class="o">+</span> <span class="n">n</span> <span class="o">*</span> <span class="n">n</span>
    <span class="k">return</span> <span class="nb">sum</span>

<span class="s">'''
# 当如果要使用list传入的话
'''</span>
<span class="n">nums</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="n">calc</span><span class="p">(</span><span class="o">*</span><span class="n">nums</span><span class="p">)</span>
</code></pre></div></div>

<ul>
  <li>关键字参数的用法和可变参数类似</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># 定义
</span><span class="o">**</span><span class="n">kw</span>
<span class="c1">#调用
</span><span class="o">&gt;&gt;&gt;</span> <span class="n">extra</span> <span class="o">=</span> <span class="p">{</span><span class="s">'city'</span><span class="p">:</span> <span class="s">'Beijing'</span><span class="p">,</span> <span class="s">'job'</span><span class="p">:</span> <span class="s">'Engineer'</span><span class="p">}</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">person</span><span class="p">(</span><span class="s">'Jack'</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="o">**</span><span class="n">extra</span><span class="p">)</span>
</code></pre></div></div>

<ul>
  <li>命名关键字参数</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># 无可变参数时 必须加入*分隔
</span><span class="k">def</span> <span class="nf">person</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">age</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">city</span><span class="p">,</span> <span class="n">job</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">age</span><span class="p">,</span> <span class="n">city</span><span class="p">,</span> <span class="n">job</span><span class="p">)</span>

<span class="c1"># 有可变参数时 无序理会
</span><span class="k">def</span> <span class="nf">person</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">age</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">city</span><span class="p">,</span> <span class="n">job</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">age</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">city</span><span class="p">,</span> <span class="n">job</span><span class="p">)</span>
</code></pre></div></div>

<ul>
  <li>参数组合</li>
</ul>

<p>目前共有五种参数</p>

<ol>
  <li>必选</li>
  <li>默认</li>
  <li>可变</li>
  <li>关键字</li>
  <li>命名关键字</li>
</ol>

<p>定义必须遵循以上顺序</p>

<h3 id="递归函数">递归函数</h3>

<ul>
  <li>
    <p>递归需要注意一点就是: 防止函数栈溢出</p>
  </li>
  <li>
    <p>尽可能的采用尾递归方式来处理递归函数</p>
    <ul>
      <li>尾递归：函数返回的时候, 只调用该函数本身, 不能添加其他的表达式.</li>
    </ul>
  </li>
</ul>

<h2 id="高级特性">高级特性</h2>

<h3 id="切片">切片</h3>

<ul>
  <li>当如果采用-号来进行倒序取数的时候, 并不是取得顺序也是倒的, 而是正序.</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">L</span> <span class="o">=</span> <span class="p">[</span><span class="s">'Michael'</span><span class="p">,</span> <span class="s">'Sarah'</span><span class="p">,</span> <span class="s">'Tracy'</span><span class="p">,</span> <span class="s">'Bob'</span><span class="p">,</span> <span class="s">'Jack'</span><span class="p">]</span>
<span class="n">L</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">:]</span>
<span class="c1"># 这个-2指从倒数第二个开始, 继续往后取值, 而不是往前取值.
# 即: ['Bob', 'Jack']
# 而不是 ['Bob', 'Tracy', 'Sarah', 'Michael']
</span></code></pre></div></div>

<h3 id="迭代">迭代</h3>

<ul>
  <li>
    <p>字典直接遍历时取得是所有的键, 需要字典的所有值是 <code class="highlighter-rouge">dic.values()</code>, 所有键值对是 <code class="highlighter-rouge">dic.items()</code></p>
  </li>
  <li>
    <p><code class="highlighter-rouge">Iterable</code>: 可迭代 <code class="highlighter-rouge">from collections import Iterable</code></p>
  </li>
  <li>
    <p><code class="highlighter-rouge">isinstance</code>: 判断一个对象的类型 <code class="highlighter-rouge">isinstance(object, class-or-type-or-tuple)</code></p>
  </li>
  <li>
    <p><code class="highlighter-rouge">enumerate</code> 将一个list改变为索引-元素对</p>
  </li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span><span class="s">'A'</span><span class="p">,</span> <span class="s">'B'</span><span class="p">,</span> <span class="s">'C'</span><span class="p">]):</span>
<span class="o">...</span>     <span class="k">print</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
<span class="o">...</span>
<span class="mi">0</span> <span class="n">A</span>
<span class="mi">1</span> <span class="n">B</span>
<span class="mi">2</span> <span class="n">C</span>
</code></pre></div></div>

<ul>
  <li>可以同时引用两个变量</li>
</ul>

<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">9</span><span class="p">)]:</span>
<span class="o">...</span>     <span class="k">print</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="o">...</span>
<span class="mi">1</span> <span class="mi">1</span>
<span class="mi">2</span> <span class="mi">4</span>
<span class="mi">3</span> <span class="mi">9</span>
</code></pre></div></div>

<ul>
  <li><code class="highlighter-rouge">for ... in</code> 是不支持直接遍历字典的时候, 同时取到键和值需要以下方法</li>
</ul>

<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># 会报错
</span><span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="s">'key_1'</span><span class="p">:</span><span class="s">'1'</span><span class="p">,</span> <span class="s">'key_2'</span><span class="p">:</span><span class="s">'2'</span><span class="p">,</span> <span class="s">'key_3'</span><span class="p">:</span><span class="s">'3'</span><span class="p">}</span>
<span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">d</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="n">key</span> <span class="o">+</span> <span class="n">value</span><span class="p">)</span>

<span class="c1"># 加上items这样就不会报错了
</span><span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="s">'key_1'</span><span class="p">:</span><span class="s">'1'</span><span class="p">,</span> <span class="s">'key_2'</span><span class="p">:</span><span class="s">'2'</span><span class="p">,</span> <span class="s">'key_3'</span><span class="p">:</span><span class="s">'3'</span><span class="p">}</span>
<span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">d</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="k">print</span><span class="p">(</span><span class="n">key</span> <span class="o">+</span> <span class="n">value</span><span class="p">)</span>
</code></pre></div></div>

<h3 id="列表生成器">列表生成器</h3>

<ul>
  <li><code class="highlighter-rouge">[]</code></li>
</ul>

<h3 id="生成器-generator">生成器: generator</h3>

<ul>
  <li><code class="highlighter-rouge">()</code> 或者 <code class="highlighter-rouge">yield</code></li>
</ul>

<h3 id="迭代器-iterator">迭代器: Iterator</h3>

<ul>
  <li>凡是可作用于<code class="highlighter-rouge">for</code>循环的对象都是<code class="highlighter-rouge">Iterable</code>类型；</li>
  <li>凡是可作用于<code class="highlighter-rouge">next()</code>函数的对象都是<code class="highlighter-rouge">Iterator</code>类型，它们表示一个惰性计算的序列；</li>
  <li>集合数据类型如<code class="highlighter-rouge">list、dict、str</code>等是<code class="highlighter-rouge">Iterable</code>但不是<code class="highlighter-rouge">Iterator</code>，不过可以通过<code class="highlighter-rouge">iter()</code>函数获得一个<code class="highlighter-rouge">Iterator</code>对象。</li>
  <li><code class="highlighter-rouge">for</code>循环本质上就是通过不断调用<code class="highlighter-rouge">next()</code>函数实现的</li>
</ul>

<h2 id="函数式编程">函数式编程</h2>

<h3 id="builtins-内置函数">builtins: 内置函数</h3>

<ul>
  <li><code class="highlighter-rouge">abs</code>就在<code class="highlighter-rouge">import builtins</code></li>
</ul>

<h3 id="高阶函数">高阶函数</h3>

<ul>
  <li>
    <p><code class="highlighter-rouge">map</code> 对每个数进行一次函数算法, 然后重新组装为一个数组.</p>
  </li>
  <li>
    <p><code class="highlighter-rouge">reduce</code> 从 0, 1 每两个, 直到最后一个数进行一次函数算法, 然后返回.</p>
  </li>
  <li>
    <p><code class="highlighter-rouge">filter</code> 遍历每个数对其进行过滤 真保存, 假删除.</p>
  </li>
</ul>

<blockquote>
  <p>以上都是返回的是 <code class="highlighter-rouge">Iterator</code> 类型 需要用<code class="highlighter-rouge">list()</code>让其算完.</p>
</blockquote>

<h2 id="模块">模块</h2>

<h3 id="使用模块">使用模块</h3>

<ul>
  <li>
    <p><code class="highlighter-rouge">sys.argv</code>存储了命令行输入参数, 当长度为1时没有输入参数.</p>
  </li>
  <li>
    <p><code class="highlighter-rouge">if __name__=='__main__':</code> 被引入使用时失效, 仅在运行当前文件时生效, 主要用于测试.</p>
  </li>
</ul>

<h3 id="安装第三方模块">安装第三方模块</h3>

<ul>
  <li>模块搜索路径 环境修改<code class="highlighter-rouge">PYTHONPATH</code></li>
</ul>

<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># 仅仅在运行时添加
</span><span class="kn">import</span> <span class="nn">sys</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">'/Users/michael/my_py_scripts'</span><span class="p">)</span>
</code></pre></div></div>

<h2 id="面向对象编程">面向对象编程</h2>

<h3 id="获取对象信息">获取对象信息</h3>

<ul>
  <li>
    <p>获取对象所有方法 <code class="highlighter-rouge">dir()</code></p>
  </li>
  <li>
    <p>类似OC动态运行时 <code class="highlighter-rouge">getattr()</code> <code class="highlighter-rouge">setattr()</code> <code class="highlighter-rouge">hasattr()</code></p>
  </li>
</ul>

<h2 id="面向对象高级编程">面向对象高级编程</h2>

<h3 id="使用__slots__">使用__slots__</h3>

<ul>
  <li>python的动态能力很强, 甚至可以给类添加绑定一个方法, 或者是给对象绑定一个参数. 但有问题就是想起限制作用, 这时候就可以使用到了__slots__</li>
</ul>

<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Student</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="n">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s">'name'</span><span class="p">,</span> <span class="s">'age'</span><span class="p">)</span> <span class="c1"># 用tuple定义允许绑定的属性名称
</span><span class="s">'''
这里补充下网友发现的一些现象
1. 如果设置了__slots__ 但是给类直接绑定新的值, 还是可行 eg: Student.score = 99
2. 如果采用了__slots__内含有双下划线的变量时, 在继承的时候该 变量会变形 eg: Person __slots__('__name') Student(Person) __slots__() 这时候的Student的name在用的时候会报错. 由于其没有改写本身的__name, 所以已经变形为_Persion__name
'''</span>
</code></pre></div></div>

<h3 id="定制类">定制类</h3>

<ul>
  <li><code class="highlighter-rouge">__init__</code>    初始化的时候使用</li>
  <li><code class="highlighter-rouge">__len__</code>     <code class="highlighter-rouge">len()</code>方法的时候</li>
  <li><code class="highlighter-rouge">__str__</code>     <code class="highlighter-rouge">print()</code>方法的时候</li>
  <li><code class="highlighter-rouge">__repr__</code>    命令行直接输出的时候</li>
  <li><code class="highlighter-rouge">__iter__</code>    返回迭代所需要的对象</li>
  <li><code class="highlighter-rouge">__next__</code>    返回下一个取出来的值</li>
  <li><code class="highlighter-rouge">__getitem__</code> <code class="highlighter-rouge">[::]</code>的方式取下标</li>
  <li><code class="highlighter-rouge">__getattr__</code> 通常用作获取一个没有的值得属性的时候</li>
  <li><code class="highlighter-rouge">__call__</code>    判断是否可调用的具体条件<code class="highlighter-rouge">callable()</code></li>
</ul>

<h3 id="元类">元类</h3>

<ul>
  <li>类可以通过 <code class="highlighter-rouge">type()</code> 直接去创建.</li>
</ul>

<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">fn</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s">'world'</span><span class="p">):</span> <span class="c1"># 先定义函数
</span>    <span class="k">print</span><span class="p">(</span><span class="s">'Hello, </span><span class="si">%</span><span class="s">s.'</span> <span class="o">%</span> <span class="n">name</span><span class="p">)</span>
<span class="n">Hello</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="s">'Hello'</span><span class="p">,</span> <span class="p">(</span><span class="nb">object</span><span class="p">,),</span> <span class="nb">dict</span><span class="p">(</span><span class="n">hello</span><span class="o">=</span><span class="n">fn</span><span class="p">))</span> <span class="c1"># 创建Hello class
</span></code></pre></div></div>

<ul>
  <li>而<code class="highlighter-rouge">metaclass</code>本质上就是监听创建这个类时的回调, 从而在本源上大规模的去改动这个类的创建形式.</li>
</ul>

<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">ListMetaclass</span><span class="p">(</span><span class="nb">type</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__new__</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">bases</span><span class="p">,</span> <span class="n">attrs</span><span class="p">):</span>
        <span class="n">attrs</span><span class="p">[</span><span class="s">'add'</span><span class="p">]</span> <span class="o">=</span> <span class="k">lambda</span> <span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">type</span><span class="o">.</span><span class="n">__new__</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">bases</span><span class="p">,</span> <span class="n">attrs</span><span class="p">)</span>
<span class="k">class</span> <span class="nc">MyList</span><span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="n">metaclass</span><span class="o">=</span><span class="n">ListMetaclass</span><span class="p">):</span>
    <span class="k">pass</span>
<span class="s">'''
&gt;&gt;&gt; L = MyList()
&gt;&gt;&gt; L.add(1)
&gt;&gt; L
[1]
'''</span>
</code></pre></div></div>

<h2 id="io编程">IO编程</h2>

<h3 id="序列化">序列化</h3>

<ul>
  <li>模型转json</li>
</ul>

<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># 自定义模式
</span><span class="k">def</span> <span class="nf">student2dict</span><span class="p">(</span><span class="n">std</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">{</span>
        <span class="s">'name'</span><span class="p">:</span> <span class="n">std</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
        <span class="s">'age'</span><span class="p">:</span> <span class="n">std</span><span class="o">.</span><span class="n">age</span><span class="p">,</span>
        <span class="s">'score'</span><span class="p">:</span> <span class="n">std</span><span class="o">.</span><span class="n">score</span>
    <span class="p">}</span>
<span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">student2dict</span><span class="p">)</span>

<span class="c1"># 偷懒模式
</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="k">lambda</span> <span class="n">obj</span><span class="p">:</span> <span class="n">obj</span><span class="o">.</span><span class="n">__dict__</span><span class="p">)</span>
</code></pre></div></div>

<ul>
  <li>json转模型</li>
</ul>

<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">dict2student</span><span class="p">(</span><span class="n">d</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">Student</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="s">'name'</span><span class="p">],</span> <span class="n">d</span><span class="p">[</span><span class="s">'age'</span><span class="p">],</span> <span class="n">d</span><span class="p">[</span><span class="s">'score'</span><span class="p">])</span>
<span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">json_str</span><span class="p">,</span> <span class="n">object_hook</span><span class="o">=</span><span class="n">dict2student</span><span class="p">)</span>
</code></pre></div></div>

<h2 id="进程和线程">进程和线程</h2>

<h3 id="多线程">多线程</h3>

<ul>
  <li>
    <p>GIL</p>

    <p>启动与CPU核心数量相同的N个线程，在4核CPU上可以监控到CPU占用率仅有102%，也就是仅使用了一核。</p>

    <p>但是用C、C++或Java来改写相同的死循环，直接可以把全部核心跑满，4核就跑到400%，8核就跑到800%，为什么Python不行呢？</p>

    <p>因为Python的线程虽然是真正的线程，但解释器执行代码时，有一个GIL锁：Global Interpreter Lock，任何Python线程执行前，必须先获得GIL锁，然后，每执行100条字节码，解释器就自动释放GIL锁，让别的线程有机会执行。这个GIL全局锁实际上把所有线程的执行代码都给上了锁，所以，多线程在Python中只能交替执行，即使100个线程跑在100核CPU上，也只能用到1个核。</p>

    <p>GIL是Python解释器设计的历史遗留问题，通常我们用的解释器是官方实现的CPython，要真正利用多核，除非重写一个不带GIL的解释器。</p>

    <p>所以，在Python中，可以使用多线程，但不要指望能有效利用多核。如果一定要通过多线程利用多核，那只能通过C扩展来实现，不过这样就失去了Python简单易用的特点。</p>

    <p>不过，也不用过于担心，Python虽然不能利用多线程实现多核任务，但可以通过多进程实现多核任务。多个Python进程有各自独立的GIL锁，互不影响。</p>
  </li>
</ul>

  </div>

  
    <div class="post-comments" itemprop="comment">
      

<div id="disqus_thread"></div>
<script>

/**
*  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
*  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/
/*
var disqus_config = function () {
this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};
*/
(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');
s.src = 'https://danyow.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>


<script id="dsq-count-scr" src="//danyow.disqus.com/count.js" async></script>


    </div>
  

</article>

      </div>
    </main>

    <footer class="site-footer">

  <div class="wrapper">

    <p>
      

&copy;  - Powered by <a href="https://jekyllrb.com">Jekyll</a> &amp; <a href="https://github.com/yous/whiteglass">whiteglass</a> - Subscribe via <a href="https://blog.danyow.cn/feed.xml">RSS</a>

    </p>

  </div>

</footer>


  </body>

</html>
