<!DOCTYPE html>
<html lang="en">

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  
  
  <title>Hello World!</title>
  <meta name="description" content="jekyll 静态页面框架 whiteglass 主题 Disqus 评论系统（国内IP应该无法访问） Travis CI 自动构建工具">
  

  <link rel="stylesheet" href="/assets/main.css">
  <link rel="canonical" href="https://blog.danyow.cn/2019/05/26/hello-world/">
  
  
  <link rel="alternate" type="application/rss+xml" title="📒 Danyow" href="https://blog.danyow.cn/feed.xml">

  

  
  <meta property="og:title" content="Hello World!">
  <meta property="og:site_name" content="📒 Danyow">
  <meta property="og:url" content="https://blog.danyow.cn/2019/05/26/hello-world/">
  <meta property="og:description" content="jekyll 静态页面框架 whiteglass 主题 Disqus 评论系统（国内IP应该无法访问） Travis CI 自动构建工具">
  
  
  <meta name="twitter:card" content="summary">
  
  <meta name="twitter:title" content="Hello World!">
  <meta name="twitter:description" content="jekyll 静态页面框架 whiteglass 主题 Disqus 评论系统（国内IP应该无法访问） Travis CI 自动构建工具">
  
  

  <link rel="dns-prefetch" href="https://fonts.gstatic.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css?family=Bitter:400,400i,700&display=swap" rel="stylesheet">

  

</head>


  <body>

    <header class="site-header">

  <div class="wrapper">

    <a class="site-title" href="/">📒 Danyow</a>

    <nav class="site-nav">
      
        
        <a class="page-link" href="/about/">关于</a>
      
        
        <a class="page-link" href="/archives/">归档</a>
      
        
        <a class="page-link" href="https://github.com/danyow">GitHub</a>
      
    </nav>

  </div>

</header>


    <main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    
      <h1 class="post-title" itemprop="name headline">Hello World!</h1>
    
    <p class="post-meta"><time datetime="2019-05-26T04:40:24+00:00" itemprop="datePublished">May 26, 2019</time> •
  
    
    
      
        <a href="/categories/jekyll/">jekyll</a>,
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  
    
    
      
    
      
        <a href="/categories/whiteglass/">whiteglass</a>,
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  
    
    
      
    
      
    
      
        <a href="/categories/disqus/">Disqus</a>,
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  
    
    
      
    
      
    
      
    
      
        <a href="/categories/travis/">Travis</a>
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  



</p>
  </header>

  <div class="post-content" itemprop="articleBody">
    <ol>
  <li><strong>jekyll</strong> 静态页面框架</li>
  <li><strong>whiteglass</strong> 主题</li>
  <li><strong>Disqus</strong> 评论系统（国内<em>IP</em>应该无法访问）</li>
  <li><strong>Travis CI</strong> 自动构建工具</li>
</ol>

<h2 id="jekyll">jekyll</h2>

<p>之所以采用 <strong>jekyll</strong> 而没有去使用中文文档更为丰富的 <em>Hexo</em>，是因为 <em>Github</em> 官方推荐的是前者。 同时也有另外一个原因，<strong>jekyll</strong> 看起来会简约许多。</p>

<p>大致步骤如下:</p>

<ol>
  <li>安装 <em>bundler</em> 和 <em>jekyll</em>
 <code class="highlighter-rouge">gem install bundler jekyll</code></li>
  <li>创建项目
<code class="highlighter-rouge">jekyll new blog</code> 和 <code class="highlighter-rouge">jekyll new blog --skip-bundle</code>
后者是针对 <strong>whiteglass</strong> 的，后面会讲到。</li>
  <li>进入目录</li>
  <li>启动本地调试
<code class="highlighter-rouge">bundle exec jekyll serve</code></li>
</ol>

<p>以上就算是把房子建好了，剩下的就是需要让房客（我的笔记）入住，和让房间更好看些（<strong>whiteglass</strong>）。<br />
这些生成出来的文件直接推送到 <em>Github</em> 时，是可以正常运行的。</p>

<h2 id="whiteglass">whiteglass</h2>

<p>这个是在 <a href="https://jekyllthemes.dev/"><em>jekyllthemes</em></a> 主题网站上面找到的。
推荐采用重新建房子的方式。</p>

<p>大致使用方法:</p>

<ol>
  <li>创建项目 <code class="highlighter-rouge">jekyll new blog --skip-bundle</code></li>
  <li>添加 <code class="highlighter-rouge">gem "jekyll-whiteglass"</code> 到 <code class="highlighter-rouge">Gemfile</code></li>
  <li>
    <p>编辑 <code class="highlighter-rouge">_config.yml</code></p>

    <div class="language-yml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="na">theme</span><span class="pi">:</span> <span class="s">jekyll-whiteglass</span>
  <span class="na">plugins</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="s">jekyll-archives</span>
  <span class="pi">-</span> <span class="s">jekyll-paginate</span>
  <span class="pi">-</span> <span class="s">jekyll-sitemap</span>

  <span class="na">permalink</span><span class="pi">:</span> <span class="s">/:year/:month/:day/:title/</span>
  <span class="na">paginate_path</span><span class="pi">:</span> <span class="s">/posts/:num/</span>
  <span class="na">paginate</span><span class="pi">:</span> <span class="s">5</span>

  <span class="na">jekyll-archives</span><span class="pi">:</span>
  <span class="na">enabled</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">categories</span>
      <span class="pi">-</span> <span class="s">tags</span>
  <span class="na">layout</span><span class="pi">:</span> <span class="s">category_archives</span>
  <span class="na">permalinks</span><span class="pi">:</span>
      <span class="na">category</span><span class="pi">:</span> <span class="s">/categories/:name/</span>
   <span class="na">tag</span><span class="pi">:</span> <span class="s">/tags/:name/</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p>依次执行以下命令</p>

    <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="nb">rm </span>index.md
 curl <span class="nt">-L</span> <span class="nt">-O</span> <span class="s2">"https://github.com/yous/whiteglass/raw/master/{index.html,about.md,archives.md,feed.xml}"</span>
 curl <span class="nt">-L</span> <span class="nt">--create-dirs</span> <span class="nt">-o</span> _data/navigation.yml https://github.com/yous/whiteglass/raw/master/_data/navigation.yml
</code></pre></div>    </div>
  </li>
  <li>
    <p>安装所需文件和启动</p>

    <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code> bundle <span class="nb">install
 </span>bundle <span class="nb">exec </span>jekyll serve
</code></pre></div>    </div>
  </li>
</ol>

<p>但这里做完之后直接推送到 <em>Github</em> 上时是没有任何反应，看不到任何界面。
这时需要 <strong>Travis CI</strong></p>

<h2 id="travis-ci">Travis CI</h2>

<p>由于主题用到了 <em>gem</em> 包，而 <em>Github</em> 又并不能直接支持去操作 <em>gem</em>，所以需要一个类似 <em>Jenkins</em> 的持续集成工具来完成该操作。<br />
<strong>Travis</strong> 会根据当前 <em>master</em> 分支下的 <code class="highlighter-rouge">.travis.yml</code> 这个文件去执行相应操作。<br />
根目录下新建 <code class="highlighter-rouge">.travis.yml</code> 或者去 <a href="https://github.com/yous/whiteglass/blob/master/.travis.yml">下载最新的文件</a></p>

<div class="language-yml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">language</span><span class="pi">:</span> <span class="s">ruby</span>
<span class="na">sudo</span><span class="pi">:</span> <span class="no">false</span>
<span class="na">cache</span><span class="pi">:</span> <span class="s">bundler</span>
<span class="na">rvm</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="s">2.6.3</span>
<span class="na">before_install</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="s">gem update --system</span>
  <span class="pi">-</span> <span class="s">gem install bundler</span>
<span class="na">script</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="s">rm -rf _site</span>
  <span class="pi">-</span> <span class="s">bundle exec jekyll build</span>
<span class="na">branches</span><span class="pi">:</span>
  <span class="na">only</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">master</span>
<span class="na">deploy</span><span class="pi">:</span>
  <span class="na">provider</span><span class="pi">:</span> <span class="s">pages</span>
  <span class="na">skip-cleanup</span><span class="pi">:</span> <span class="no">true</span>
  <span class="na">github-token</span><span class="pi">:</span> <span class="s">$GITHUB_TOKEN</span>  <span class="c1"># &lt;-- 1</span>
  <span class="na">keep-history</span><span class="pi">:</span> <span class="no">true</span>
  <span class="na">local-dir</span><span class="pi">:</span> <span class="s">_site</span>
  <span class="na">target-branch</span><span class="pi">:</span> <span class="s">gh-pages</span>   <span class="c1"># &lt;-- 2</span>
  <span class="na">on</span><span class="pi">:</span>
    <span class="na">branch</span><span class="pi">:</span> <span class="s">master</span>
</code></pre></div></div>

<p><em>yml</em> 区别于 <em>xml</em>，其中 <em>tab</em> 键以两个空格为主，可读性很高。</p>

<p>有几点说明:</p>

<ol>
  <li>这个参数不需要修改，但是需要在 <em>Github</em> 的设置（<em>Settings</em>）后台的（<em>Developer settings</em>）上添加一个（<em>Personal access tokens</em>）. 得到这个 <em>key</em> 后添加到 <strong>Travis</strong> 的对应仓库的设置后台。 在 <em>Environment Variables</em> 键入 <em>GITHUB_TOKEN</em> 为 <em>Name</em>，<em>key</em> 为 <em>Value</em>。 然后直接 <em>Add</em> 即可。</li>
  <li>这里需要新建一个名为 <em>gh-pages</em> 的分支，主要是给 <strong>Travis</strong> 自动构建完后推送用。</li>
</ol>

<p>做完这些，新建一个新的提交，<strong>Travis</strong> 就会自动开始运行，然后就可以查看网页了。</p>

<ul>
  <li>可能这里也并不能直接的查看网页，需要修改 <code class="highlighter-rouge">_config.yml</code></li>
</ul>

<div class="language-yml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">baseurl</span><span class="pi">:</span> <span class="s2">"</span><span class="s">/blog"</span> <span class="c1"># 为你的项目名</span>
<span class="na">url</span><span class="pi">:</span> <span class="s2">"</span><span class="s">https://xxx.github.io"</span>    <span class="c1"># xxx为你的 Github 用户名</span>
</code></pre></div></div>

<h2 id="disqus">Disqus</h2>

<p>这个会比较简单:</p>

<ol>
  <li>新建目录和文件 <code class="highlighter-rouge">_includes/custom_comments_provider.html</code></li>
  <li>添加 <code class="highlighter-rouge">comments: true</code> 到 <code class="highlighter-rouge">_config.yml</code></li>
</ol>

<p>然后去到 <strong>Disqus</strong> 的后台，新建站点，然后选择 <strong>jekyll</strong>，把他的通用代码全部拷贝到刚刚新建的 <em>html</em> 文件当中。</p>

<h3 id="其他">其他</h3>

<blockquote>
  <p>自定义域名</p>
</blockquote>

<ol>
  <li>
    <p>自定义域名解析三处。</p>

    <div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>*.xxx.com
www.xxx.com
@.xxx.com
</code></pre></div>    </div>
  </li>
  <li><em>ip</em> 地址的获取 <code class="highlighter-rouge">ping xxx.github.io</code></li>
  <li>
    <p>由于变成了子域名，需要更改<code class="highlighter-rouge">_config.xml</code></p>

    <div class="language-yml highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="na">baseurl</span><span class="pi">:</span> <span class="s2">"</span><span class="s">"</span>
 <span class="na">url</span><span class="pi">:</span> <span class="s2">"</span><span class="s">https://blog.xxx.com"</span>    <span class="c1"># blog作为子域名放在前面 xxx为你的 Github 用户名</span>
</code></pre></div>    </div>
  </li>
</ol>

<blockquote>
  <p>Ps: 2019年8月2日更新</p>
</blockquote>

<p>由于最近在 <em>Windows</em> 平台上开发, 所以遇到一个问题.
<em>Travis CI</em> 不会自动运行构建了. 应该说每次运行都会报错.
查找发现有个回答</p>

<p><code class="highlighter-rouge">啊，我明白了。您正在使用Windows计算机进行开发，但构建将在Linux上运行。如果您无法访问Linux机器，我认为最好不要Gemfile.lock登录您的Git存储库。</code></p>


  </div>

  
    <div class="post-comments" itemprop="comment">
      

<div id="disqus_thread"></div>
<script>

/**
*  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
*  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/
/*
var disqus_config = function () {
this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};
*/
(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');
s.src = 'https://danyow.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>


<script id="dsq-count-scr" src="//danyow.disqus.com/count.js" async></script>


    </div>
  

</article>

      </div>
    </main>

    <footer class="site-footer">

  <div class="wrapper">

    <p>
      

&copy;  - Powered by <a href="https://jekyllrb.com">Jekyll</a> &amp; <a href="https://github.com/yous/whiteglass">whiteglass</a> - Subscribe via <a href="https://blog.danyow.cn/feed.xml">RSS</a>

    </p>

  </div>

</footer>


  </body>

</html>
